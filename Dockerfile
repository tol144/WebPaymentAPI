# Указывает базовый образ для создания нового образа. 
# В данном случае используется "slim" версия Python 3.10, 
# которая является легковесной и содержит минимальный набор пакетов.
FROM python:3.11-slim

# Устанавливает переменную окружения PYTHONUNBUFFERED в значение 1. 
# Это означает, что вывод Python будет немедленно отображаться в stdout, а не буферизоваться. 
# Это полезно для получения логов в реальном времени.
ENV PYTHONUNBUFFERED 1

# Устанавливает рабочую директорию для последующих команд. 
# Все команды RUN, CMD, ENTRYPOINT, COPY, и т.д. будут выполняться из этой директории.
WORKDIR /code

# Копируем все файлы из текущей директории (где находится Dockerfile) в директорию /code внутри образа.
COPY . /code

RUN apt-get update \
    && apt-get install -y curl unzip libpq-dev gcc \
    && rm -rf /var/lib/apt/lists/*

#  Устанавливает все зависимости Python, указанные в файле requirements.txt, 
# с помощью pip. Параметр --no-cache-dir уменьшает размер образа, не сохраняя кэш пакетов.
RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt

# Указывает команду, которая будет выполнена при запуске контейнера. 
# В данном случае это будет запуск Python-скрипта main.py с помощью bash.
CMD ["bash", "-c", "python main.py"] 
